@(user: org.intracer.wmua.User,
editUserForm: Form[org.intracer.wmua.User],
round: Option[org.intracer.wmua.Round])(implicit flash: Flash, lang: Lang, messages: Messages)

@import helper._
@import org.intracer.wmua.User


@main(Messages("edit user"), user, user.id.get) {
    <div class="row" >
        <div class="col-md-4">


        @if(editUserForm("id").value != Some("0")) {
            <h3>@Messages("Edit user")</h3>
        } else {
            <h3>@Messages("Create user")</h3>
        }

@form(routes.Admin.saveUser, 'class -> "form-vertical") {

    @if(editUserForm.hasGlobalErrors) {
        <div class="alert alert-danger" role="alert">
            @Messages(editUserForm.errors.head.message)
        </div>
    }

    <fieldset>
        <input type="hidden" id="id" name="id" value='@editUserForm("id").value' />
        <input type="hidden" name="contest" id="contest" value='@editUserForm("contest").value' />

        <div class="form-group">
            <label for="fullname" class="control-label">@Messages("Name")</label>
            <input type="text" class="form-control" id="fullname" name="fullname" placeholder="@Messages("Name")" value="@editUserForm("fullname").value">
        </div>
        <div class="form-group">
            <label for="email" class="control-label">@Messages("Email")</label>
            <input type="text" class="form-control" id="email" name="email" placeholder="@Messages("Email")" value="@editUserForm("email").value">
        </div>

        @if(user.roles.contains("admin")) {
            @select(editUserForm("roles"), Seq("no", "jury", "organizer", "admin").map(x => (x, x)),
                Seq('_label -> Messages("Role"), '_help -> "") ++
                        (if(!user.roles.contains("admin")) Seq('disabled -> "true") else Seq.empty): _*)
        }

        @select(editUserForm("lang"), Seq("en", "ru", "uk" ).map(x => (x, User.LANGS(x))),
            '_label -> Messages("Language"), '_help -> "" )

        @if(Some(user.id.toString) == editUserForm("id").value) {
            <div class="form-group">
                <label for="password" class="control-label">@Messages("Password")</label>
                <input type="password" class="form-control" id="password" name="password" placeholder="Password" value="">
            </div>
        } else {
            @if(editUserForm("id").value != Some("0")) {
                @flash.get("password-reset").map { msg =>
                    <div class="alert alert-success">@msg</div>
                }

                <a href="#" class="btn" onclick="document.forms['reset-password'].submit();">@Messages("Reset password")</a>
            }
        }

    </fieldset>

    <div class="form-actions">
        <input type="submit" class="btn btn-default btn-primary" value="@Messages("Save")">
        <a href="/" class="btn btn-default">@Messages("Cancel")</a>
    </div>
}

        <div style="display:none;">
        @form(routes.Admin.resetPassword(editUserForm("id").value.get), 'class -> "form-vertical", 'id -> "reset-password" ) {
                <input type="submit" class="btn" value="@Messages("Reset password")">
        }
        </div>
        </div>
    </div>
}