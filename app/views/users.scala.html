@import org.intracer.wmua.ContestJury
@(
        adminUser: org.intracer.wmua.User,
        users: Seq[org.intracer.wmua.User],
        editUserForm: Form[org.intracer.wmua.User],
        contest: ContestJury)(implicit flash: Flash, lang: Lang, messages: Messages)
    @import helper._
    @import views.html.bootstrap._

    @mainAdmin(Messages("users"), adminUser, adminUser.id.get, contestId = contest.id) {
        <div class="row" >
            <h3>@Messages("Contest: " + contest.fullName)</h3>

            <div class="form-actions">
                <a href="@routes.Admin.importUsers(contest.id)">
                    <div class="btn btn-primary">
                        Mass import
                    </div>
                </a>

                <a href="@routes.Admin.editGreeting(contest.id)">
                    <div class="btn btn-primary">
                        Edit greeting message
                    </div>
                </a>
            </div>


            <table class="table table-striped table-condensed" style="background-color: #CCCCCC ;">

                <thead>
                    <tr>
                        <th>@Messages("name")</th>
                        <th>@Messages("email")</th>
                        <th>@Messages("role")</th>
                        <th>@Messages("edit")</th>
                    </tr>
                </thead>

                <tbody>

                    @for(user <- users) {
                        <tr>
                            <td>@user.fullname </td>
                            <td>@user.email </td>
                            <td>@user.roles.filterNot(_.startsWith("USER_ID")).mkString(", ") </td>
                            <td>
                                <a href="/users/edit/@user.id">
                                    <button type="button" class="btn btn-default btn-xs">
                                        <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                                    </button>
                                </a>
                            </td>
                        </tr>
                    }

                    @form(routes.Admin.saveUser, 'class -> "form-vertical", 'id -> "add-user") {
                        <tr>
                            @if(editUserForm.hasGlobalErrors) {
                                <p class="error">
                                    <span class="label important">@Messages(editUserForm.errors.head.message)</span>
                                </p>
                            }

                            <td>
                                <input type="hidden" name="id" id="id" value="0" />
                                <input type="hidden" name="contest" id="contest" value="@contest.id" />

                                @text(editUserForm("fullname"))
                            </td>
                            <td>
                                @text(editUserForm("email"))
                            </td>
                            <td>
                            @select(
                                editUserForm("roles"),
                                Seq("no", "jury", "organizer", "admin").map(x => (x, x)),
                                '_label -> "", '_help -> "", 'class -> "form-control")
                            </td>
                            <td>
                                <div class="btn btn-primary" onClick="document.forms['add-user'].submit();">
                                    <img src="https://upload.wikimedia.org/wikipedia/commons/5/5a/Farm-Fresh_group_add.png">
                                </div>
                            </td>
                        </tr>
                    }
                </tbody>

            </table>
        </div>
    }


