@import db.scalikejdbc.ContestJuryJdbc
@(
        adminUser: org.intracer.wmua.User,
        users: Seq[org.intracer.wmua.User],
        editUserForm: Form[org.intracer.wmua.User],
        round: org.intracer.wmua.Round)(implicit flash: Flash, lang: Lang, messages: Messages)
@import helper._
@import org.intracer.wmua.ContestJury

@main(Messages("users"), adminUser, adminUser.id.get) {
    <div class="row" >
        <h3>@Messages("Contest: " + ContestJuryJdbc.byId(adminUser.contest).name)</h3>

        <table class="table table-striped table-condensed" style="background-color : #CCCCCC ;">

            <thead>
                <tr>
                    <th>@Messages("Name")</th>
                    <th>@Messages("Email")</th>
                    <th>@Messages("Role")</th>
                    <th>@Messages("Edit")</th>
                </tr>
            </thead>

            <tbody>

                @for(user <- users) {
                    <tr>
                        <td>@user.fullname </td>
                        <td>@user.email </td>
                        <td>@user.roles.filterNot(_.startsWith("USER_ID")) </td>
                        <td>
                            <a href="/users/edit/@user.id"><div class="btn"><i class="icon-edit"></i></div></a>
                        </td>
                    </tr>
                }

                @form(routes.Admin.saveUser, 'class -> "form-vertical", 'id -> "add-user") {
                    <tr>
                        @if(editUserForm.hasGlobalErrors) {
                            <p class="error">
                                <span class="label important">@Messages(editUserForm.errors.head.message)</span>
                            </p>
                        }

                        <td>
                        <input type="hidden" name="id" id="id" value="0" />
                        <input type="hidden" name="contest" id="contest" value="@adminUser.contest" />
                        @inputText(
                            editUserForm("fullname"),
                            'placeholder -> Messages("Name"),
                            '_label -> null,
                            '_help -> ""
                        )
                        </td>
                        <td>
                        @inputText(
                            editUserForm("email"),
                            'placeholder -> Messages("Email"),
                            '_label -> null,
                            '_help -> ""
                        )</td>
                        <td>
                            @select(editUserForm("roles"), Seq("no", "jury", "organizer", "admin").map(x => (x,x)), '_label -> "", '_help -> "")
                        </td>
                        <td>
                            <div class="btn btn-primary" onClick="document.forms['add-user'].submit();">
                                <img src="https://upload.wikimedia.org/wikipedia/commons/5/5a/Farm-Fresh_group_add.png">
                            </div>
                        </td>
                    </tr>
                }
            </tbody>

        </table>

    </div>
}


